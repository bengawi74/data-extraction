.PHONY: install extract validate eda all clean test

install:
	python -m pip install --upgrade pip
	python -m pip install -r requirements.txt || true

extract:
	source .venv/bin/activate && python -m src.extract_pipeline

validate:
	source .venv/bin/activate && python -c "from src.validate import validate_path; validate_path('data/processed/orders_customers_users.csv')"

eda:
	source .venv/bin/activate && python -m src.eda

all: extract validate eda

clean:
	rm -rf data/processed/*.csv data/processed/*.parquet reports/

test:
	source .venv/bin/activate && ruff check .
	source .venv/bin/activate && black --check .
	source .venv/bin/activate && pytest --cov=src --cov-report=term-missing -q
